From b5cae1f8e9376c82e68b76e7f87aa9b111205ada Mon Sep 17 00:00:00 2001
From: Natalia Kovalenko <natasha.k@variscite.com>
Date: Mon, 25 Aug 2025 15:14:36 +0200
Subject: [PATCH 1/3] Keep all drivers for modem as built-in

---
 .../boot/dts/freescale/imx8mp-var-dart-dt8mcustomboard.dts  | 2 +-
 arch/arm64/configs/gki_defconfig                            | 6 +++---
 arch/arm64/configs/imx8mp_gki.fragment                      | 3 +++
 3 files changed, 7 insertions(+), 4 deletions(-)

diff --git a/arch/arm64/configs/gki_defconfig b/arch/arm64/configs/gki_defconfig
index abf7b41cdc856..663c6abe6d842 100644
--- a/arch/arm64/configs/gki_defconfig
+++ b/arch/arm64/configs/gki_defconfig
@@ -341,10 +341,10 @@ CONFIG_PPP_DEFLATE=m
 CONFIG_PPP_MPPE=m
 CONFIG_PPTP=m
 CONFIG_PPPOL2TP=m
-CONFIG_USB_NET_DRIVERS=m
+CONFIG_USB_NET_DRIVERS=y
 CONFIG_USB_RTL8150=m
 CONFIG_USB_RTL8152=m
-CONFIG_USB_USBNET=m
+CONFIG_USB_USBNET=y
 CONFIG_USB_NET_CDC_EEM=m
 # CONFIG_USB_NET_NET1080 is not set
 # CONFIG_USB_NET_CDC_SUBSET is not set
@@ -497,7 +497,7 @@ CONFIG_USB_ACM=m
 CONFIG_USB_STORAGE=y
 CONFIG_USB_UAS=y
 CONFIG_USB_DWC3=y
-CONFIG_USB_SERIAL=m
+CONFIG_USB_SERIAL=y
 CONFIG_USB_SERIAL_FTDI_SIO=m
 CONFIG_USB_GADGET=y
 CONFIG_USB_CONFIGFS=y
diff --git a/arch/arm64/configs/imx8mp_gki.fragment b/arch/arm64/configs/imx8mp_gki.fragment
index 3aa760715ebdb..8de7b02c12bb5 100644
--- a/arch/arm64/configs/imx8mp_gki.fragment
+++ b/arch/arm64/configs/imx8mp_gki.fragment
@@ -172,3 +172,6 @@ CONFIG_RTC_DRV_DS1307=m
 
 CONFIG_EXTCON_PTN5150=m
 CONFIG_EXTCON_USB_GPIO=m
+
+CONFIG_USB_NET_QMI_WWAN=y
+CONFIG_USB_SERIAL_OPTION=y
-- 
2.34.1

